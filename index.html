<!DOCTYPE html>
<html>
<head>
  <title>IT202-Spring2021-BigProject</title>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href="https://unpkg.com/material-components-web@10.0.0/dist/material-components-web.min.css" rel="stylesheet">

  <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>

  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

  <style>

    .screen {
      display: none;
    }
    canvas {
      height: 100vh;
      width: 100vw;
      position: absolute;
      background-color: "white";
    }
    body {
      margin: 0;
      padding: 0;
      background-color: "white";
      /* hieght: 100%;
      overflow: hidden; */
    }

/* #getInfo {

  background-image: url('https://scx1.b-cdn.net/csz/news/800/2017/theoreticala.jpg');
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: 100% 100%;
  color: #FFFFFF;

  } */

    /* #GameScreen {
      margin: 0;
      padding: 0;
      background-color: "white";
      hieght: 100%;
      overflow: hidden;
    } */

    main {
      /* margin-left: 10px; */
    }
  </style>

  <script>
      // control the game play and pause state as screens are changed
      let pauseGame = false;
  </script>
</head>

<body>

  <header class="mdc-top-app-bar">
      <div class="mdc-top-app-bar__row">
        <section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start">
          <button class="material-icons mdc-top-app-bar__navigation-icon mdc-icon-button" aria-label="Open navigation menu">menu</button>
        <span class="mdc-top-app-bar__title">Space Explorers</span>
      </section>
    </div>
  </header>
 
  <aside class="mdc-drawer mdc-drawer--modal">
    <div class="mdc-drawer__header">
      <br>
      <img src="img/icons/icon.png" width="60" height="60"></img>
        <h3 class="mdc-drawer__title">Space Explorers</h3>
        <h6 class="mdc-drawer__subtitle">Explorer-202</h6>
    </div>
    <div class="mdc-drawer__content">
      <nav class="mdc-list">

        <!-- Home Screen -->
        <a class="mdc-list-item mdc-list-item--activated" href="#HomeScreen" aria-current="page" tabindex="0" aria-selected="true">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">home</i>
          <span class="mdc-list-item__text">Home</span>
        </a>

        <!-- How To Use Screen -->
        <a class="mdc-list-item" href="#LearnMoreScreen" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">help_outline</i>
          <span class="mdc-list-item__text">Learn More</span>
        </a>

        <!-- Image of the Day Screen -->
        <a class="mdc-list-item" href="#NASAImgScreen" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">image</i>
          <span class="mdc-list-item__text">Image of the Day</span>
        </a>

        <!-- Suit Up Screen -->
        <a class="mdc-list-item" href="#SuitUpScreen" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">photo_camera</i>
          <span class="mdc-list-item__text">Suit Up</span>
        </a>

        <!-- Game Screen -->
        <a class="mdc-list-item" href="#GameScreen" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">sports_esports</i>
          <span class="mdc-list-item__text">Start Game</span>
        </a>

        <!-- Game Stats Screen -->
        <!-- <a class="mdc-list-item" href="#Screen4" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">insert_chart_outlined</i>
          <span class="mdc-list-item__text">Game Stats</span>
        </a> -->

        <!-- History Screen -->
        <!-- <a class="mdc-list-item" href="#HistoryScreen" tabindex="-1" aria-selected="false">
          <span class="mdc-list-item__ripple"></span>
          <i class="material-icons mdc-list-item__graphic" aria-hidden="true">history</i>
          <span class="mdc-list-item__text">History</span>
        </a> -->

      </nav>
    </div>
  </aside>

  <div class="mdc-drawer-scrim"></div>
  <main class="mdc-top-app-bar--fixed-adjust">
    
    <!-- Home Screen -->
    <div id="HomeScreen" class="screen">
      <center>
      
      <!-- div to get the user info -->
      <div id="getInfo">
        
        <h5 class="mdc-typography--headline4">Welcome Explorer</h5>

        <!-- Text Input with the label Enter your name  -->
        <label class="mdc-text-field mdc-text-field--filled">
          <span class="mdc-text-field__ripple"></span>
          <span class="mdc-floating-label" id="my-label-id">Enter Your Name</span>
          <input class="mdc-text-field__input" id="EnterName" type="text" aria-labelledby="my-label-id">
          <span class="mdc-line-ripple"></span>
        </label> 
        <br> <br>
        
        
        <!-- Button to store user data and invoke snackbar -->
        <button class="mdc-button mdc-button--raised" id="JoinButton">
          <div class="mdc-button__ripple"></div>
          <span class="mdc-button__label">Join the Force</span>
        </button>

        <!-- Snackbar -->
        <div class="mdc-snackbar">
          <div class="mdc-snackbar__surface" role="status" aria-relevant="additions">
            <div class="mdc-snackbar__label" aria-atomic="false">
              Welcome Explorer
            </div>
            <div class="mdc-snackbar__actions" aria-atomic="true">
              <button type="button" class="mdc-button mdc-snackbar__action">
                <div class="mdc-button__ripple"></div>
                <span class="mdc-button__label"></span>
              </button>
            </div>
          </div>
        </div>

      </div>
      
      <!-- div that contains the introduction to the app and all the screens -->
      <div id="intro">

        <!-- app intro -->
        <h5 class="mdc-typography--headline5">What does the app do?</h5>

        <p class="mdc-typography--body1">The Application will allow you to join us in our quest to explore the known universe in search of a habitable planet. We hope that this planet will serve as our new home. This application tells you why we are in search of a new home and also how you can help us find it.</p>

        <p class="mdc-typography--body1">Use the Navigation Drawer to navigate through the pages.</p>  
      
        <!-- the search for a habitable planet -->
        <h5 class="mdc-typography--headline5">The search for a habitable planet</h5>
 
        <p class="mdc-typography--body1">The search for a habitable planet was initiated in response to the worsening environmental damage to planet Earth. Over the years, the human race has exploited the natural resources of this planet. This is causing irreversible damage to the planet we call home.</p>

        <p class="mdc-typography--body1">Visit the info page to learn more about human impact on Earth's climate.</p>

        <!-- Button to take user to climate info page -->
        <button class="mdc-button mdc-button--raised" id="GoToInfo">
          <div class="mdc-button__ripple"></div>
          <span class="mdc-button__label">Info</span>
        </button>

        <!-- learn more about space -->
        <h5 class="mdc-typography--headline5">Learn more about space</h5>

        <p class="mdc-typography--body1">You will be exploring the space in search of a habitable planet. It is essential that you learn more about space before you start exploring it. Well, lucky you!
        
        NASA uploads a new image or video about space. This will be a great source of information for you. Go to the More on Science page to get you Daily dose of Space.
        </p>

        <!-- Button to take user to Space info page -->
        <button class="mdc-button mdc-button--raised" id="GoToSpaceInfo">
          <div class="mdc-button__ripple"></div>
          <span class="mdc-button__label">Daily Dose Of Space</span>
        </button>        

        <!-- Suit Up Screen -->
        <h5 class="mdc-typography--headline5">Suit Up</h5>

        <p class="mdc-typography--body1">You are now an explorer. Before you embark on your journey, you should suit up. Go to the Suit Up page to try on our latest space gear.
        </p>        

        <!-- Button to take user to climate Suit Up page -->
        <button class="mdc-button mdc-button--raised" id="GoToSuitUp">
          <div class="mdc-button__ripple"></div>
          <span class="mdc-button__label">Suit Up</span>
        </button>

        <!-- Start Game screen -->
        <h5 class="mdc-typography--headline5">Start Exploring</h5>

        <p class="mdc-typography--body1">You are now ready. Go to the Start Exploring page to start your jourey. 
        </p>

        <!-- Button to take user to Start Game page -->
        <button class="mdc-button mdc-button--raised" id="GoToStartGame">
          <div class="mdc-button__ripple"></div>
          <span class="mdc-button__label">Explore</span>
        </button>

        <br><br><br>

      </div>

      </center>
   
    </div> 
    
    <!-- Home Screen Script -->
    <!-- Include Dexie -->
    <script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>
    <script>
      let userName;

      // Add script to initialize the components
      let textInput = mdc.textField.MDCTextField.attachTo(document.querySelector('.mdc-text-field'));

      let button = mdc.ripple.MDCRipple.attachTo(document.querySelector('.mdc-button--raised'));
    
      let snackbar = mdc.snackbar.MDCSnackbar.attachTo(document.querySelector(".mdc-snackbar"));

      var db = new Dexie("players_db");
      db.version(1).stores({
          players: 'userName'
      });

      // click event handler for the button, the snackbar text is set and the snackbar is shown.
      document.querySelector("#JoinButton").addEventListener("click", (event) => {
        // get user input from input element
        let userInput = textInput.value;
        
        let score = 0;
        console.log("prev Score : " + score);
        db.players.get(userName)
        .then( (item) => {
          console.log(typeof(item.highestScore));
          console.log(typeof(0));
          console.log(typeof(item.highestScore) == typeof(0));
          if (typeof(item.highestScore) == typeof(0)) {
            console.log("score : " + item.highestScore);
            score = item.highestScore;
            console.log("updated score : " + score);
          }
        });
        
        console.log("post Score : " + score);
        // add the userName to the database of players
        db.players.put({userName: userInput, highestScore: score, date: new Date()})
        .then ( (item) => {

          // store the user's name
          userName = userInput;

          // update and open the snackbar
          snackbar.labelText = "Welcome Explorer " + userInput;
          snackbar.open();

        });

      });
      
      // buttons in the main screen to change screens
      let b1 = mdc.ripple.MDCRipple.attachTo(document.querySelector('#GoToInfo'));
      let b2 = mdc.ripple.MDCRipple.attachTo(document.querySelector('#GoToSpaceInfo'));
      let b3 = mdc.ripple.MDCRipple.attachTo(document.querySelector('#GoToSuitUp'));
      let b4 = mdc.ripple.MDCRipple.attachTo(document.querySelector('#GoToStartGame'));

    </script>
    

    <!-- Script for the Info Screen -->
    <!--Load the AJAX API-->
    <!-- <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="script/infoScreen.js"></script> -->


    <!--Load the AJAX API-->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script>

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // fetch form the CO2 APi and draw the chart
      let co2Chart = () => {
        let lineChart = new google.visualization.DataTable();
        
        lineChart.addColumn('string','date');
        lineChart.addColumn('number','Carbon Dioxide Levels');
        
        fetch("https://global-warming.org/api/co2-api")
        .then( (response) => {
          return response.json()
        })
        .then( (json) => {
          json.co2.forEach( (elem) => {
            lineChart.addRow([elem.year +"/"+ elem.month +"/"+ elem.day, parseInt(elem.trend)]);
          });
        
        // Set chart options
        let options = {'title':'co2 levels',
        'width':1500,
        'height':500};
        
        // Instantiate and draw our chart, passing in some options.
        let chart = new google.visualization.LineChart(document.querySelector('#co2_line_chart_div'));
        chart.draw(lineChart, options);
        })
      }      
      
      // fetch from methane API and draw chart
      let methaneChart = () => {
        let lineChart = new google.visualization.DataTable();
        
        lineChart.addColumn('string','date');
        lineChart.addColumn('number','average');

        fetch("https://global-warming.org/api/methane-api")
        .then( (response) => {
          return response.json()
        })
        .then( (json) => {
          json.methane.forEach( (elem) => {
            lineChart.addRow([elem.date, parseInt(elem.average)])  });
        
        // Set chart options
        let options = {'title':'Methane levels from 1983 to 2020 (for each month)',
        'width':1500,
        'height':500};
        
        // Instantiate and draw our chart, passing in some options.
        let chart = new google.visualization.LineChart(document.querySelector('#methane_line_chart_div'));
        chart.draw(lineChart, options);
        })
      }
      
      // fetch from N2O chart and draw chart
      let n2oChart = () => {
        let lineChart = new google.visualization.DataTable();
        
        lineChart.addColumn('string','date');
        lineChart.addColumn('number','average');

        fetch("https://global-warming.org/api/nitrous-oxide-api")
        .then( (response) => {
          return response.json()
        })
        .then( (json) => {
          json.nitrous.forEach( (elem) => {
            lineChart.addRow([elem.date, parseInt(elem.average)])  });
        
        // Set chart options
        let options = {'title':'Nitrous Oxide levels from 2001 to present',
        'width':1500,
        'height':500};

        // Instantiate and draw our chart, passing in some options.
        let chart = new google.visualization.LineChart(document.querySelector('#n2o_line_chart_div'));
        chart.draw(lineChart, options);
        })
      }


      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      let drawCharts = () => {
   
        // draw the charts
        methaneChart();
        co2Chart();
        n2oChart();
      }

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawCharts);

    </script>

    <!-- Help Screen -->
    <div id="LearnMoreScreen" class="screen">
      <center>

        <h5 class="mdc-typography--headline4">App Info Screen</h5>

        <!-- div to store all the charts -->
        <div id="Charts">

          <!--Div to hold line chart of methane-->
          <div id="methane_line_chart_div"></div>

          <!--Div to hold line chart of CO2-->
          <div id="co2_line_chart_div"></div>     

          <!--Div to hold line chart of N2O-->
          <div id="n2o_line_chart_div"></div>
        
        </div>

      </center>

    </div>
    
    <!-- game screen -->
    <div id="GameScreen" class="screen">
      <!-- <h5 class="mdc-typography--headline4">Screen 3</h5> -->
      <canvas id="gameCanvas"></canvas>
    </div>

    <div id="Screen4" class="screen">
      <h5 class="mdc-typography--headline4">Game Stats Screen</h5>
    </div>

    <div id="NASAImgScreen" class="screen">
      <h5 class="mdc-typography--headline4">Image of the Day Screen</h5>
    </div>

    <div id="SuitUpScreen" class="screen">
      <h5 class="mdc-typography--headline4">Suit Up Screen</h5>
    </div>

    <div id="HistoryScreen" class="screen">
      <h5 class="mdc-typography--headline4">History Screen</h5>
    </div>
</main> 


	  <!-- script to support a SPA   -->
    <script>
      // // control the game play and pause state as screens are changed
      // let pauseGame = false;

      // define the drawer
      const drawer = mdc.drawer.MDCDrawer.attachTo(document.querySelector('.mdc-drawer'));

      // define topApp bar
      const topAppBarElement = document.querySelector('.mdc-top-app-bar');

      // navigation drawer
      const listEl = document.querySelector('.mdc-drawer .mdc-list');
      const mainContentEl = document.querySelector('main');
  
      listEl.addEventListener('click', (event) => {
        drawer.open = false;
      });

      document.querySelector("header button.mdc-top-app-bar__navigation-icon").addEventListener("click", (event) => {
        drawer.open = true;
      });
      
      // close the navbar when the user clicks anywhere
      window.addEventListener('click', () => {
        drawer.open = false;
      });

      document.body.addEventListener('MDCDrawer:closed', () => {
        // mainContentEl.querySelector('input, button').focus();
      });

      // set the screen
      let setScreen = (href) => {
        hideAllScreens();
        console.log(href);
        console.log(event);
        
        // check if the current screen is the game screen or not
        if (href != "#GameScreen") {
          pauseGame = true;

          // adjust the properties of the body to allow the scroll bar
          // document.querySelector("body").removeAttribute("hieght");
          document.querySelector("body").style.overflow = "scroll";

        } else if (href == "#GameScreen") {
          pauseGame = false;

          // adjust the properties of the body to prevent the scroll bar
          document.querySelector("body").style.height = "100%";
          document.querySelector("body").style.overflow = "hidden";
        }

        document.querySelector(href).style.display="block";
      }

    document.querySelectorAll('.mdc-list-item').forEach((element) => {
      element.addEventListener('click', (event) => {
        hideAllScreens();
        let href = event.target.getAttribute("href");
        console.log(href);
        console.log(event);
        
        // check if the current screen is the game screen or not
        if (href != "#GameScreen") {
          pauseGame = true;

          // adjust the properties of the body to allow the scroll bar
          // document.querySelector("body").removeAttribute("hieght");
          document.querySelector("body").style.overflow = "scroll";

        } else if (href == "#GameScreen") {
          pauseGame = false;

          // adjust the properties of the body to prevent the scroll bar
          document.querySelector("body").style.height = "100%";
          document.querySelector("body").style.overflow = "hidden";
        }

        document.querySelector(href).style.display="block";
      });
    });
    
    let hideAllScreens = () =>{
      document.querySelectorAll(".screen").forEach((element) => {
        element.style.display="none";
      });
    }

    // event handlers for the buttons to change screens
    document.querySelector("#GoToInfo").addEventListener("click", (event) => {
      setScreen("#LearnMoreScreen");
    });
    
    document.querySelector("#GoToSpaceInfo").addEventListener("click", (event) => {
      setScreen("#NASAImgScreen");
    });
    
    document.querySelector("#GoToSuitUp").addEventListener("click", (event) => {
      setScreen("#SuitUpScreen");
    });
    
    document.querySelector("#GoToStartGame").addEventListener("click", (event) => {
      setScreen("#GameScreen");
    });

    </script>

    <script>
      window.addEventListener('load', (event) => {
        document.querySelector("#HomeScreen").style.display="block";
      });
    </script>
    
    <!-- script for the game -->
    <script src="script/game.js"></script>

  </body>
</html>